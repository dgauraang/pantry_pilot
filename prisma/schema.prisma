generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model PantryItem {
  id             String   @id @default(cuid())
  name           String
  normalizedName String
  quantity       String?
  quantityValue  Float?
  unit           String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([normalizedName])
}

model Recipe {
  id              String   @id @default(cuid())
  title           String
  ingredientsJson String
  stepsJson       String
  notes           String?
  promptJson      String
  createdAt       DateTime @default(now())
}

model Receipt {
  id             String            @id @default(cuid())
  filePath       String
  mimeType       String
  originalName   String
  ocrText        String
  ocrConfidence  Float?
  status         String            @default("pending")
  createdAt      DateTime          @default(now())
  appliedAt      DateTime?
  lineItems      ReceiptLineItem[]
}

model ReceiptLineItem {
  id            String   @id @default(cuid())
  receiptId     String
  name          String
  normalizedName String
  quantityValue Float?
  unit          String?
  rawLine       String
  confidence    Float?
  confirmed     Boolean  @default(false)
  createdAt     DateTime @default(now())

  receipt Receipt @relation(fields: [receiptId], references: [id], onDelete: Cascade)

  @@index([receiptId])
  @@index([normalizedName])
}
